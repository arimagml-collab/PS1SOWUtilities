# PS1 SNOW Utilities

[Êó•Êú¨Ë™û](#Êó•Êú¨Ë™û) | [English](#english)

---

## Êó•Êú¨Ë™û

PS1 SNOW Utilities „ÅØ„ÄÅServiceNow „ÉÜ„Éº„Éñ„É´„ÅÆ„Éá„Éº„ÇøÊäΩÂá∫ÔºàExportÔºâ„ÉªDatabase View „ÅÆ‰ΩúÊàêÔºàDatabase View EditorÔºâ„Éª„É¨„Ç≥„Éº„ÉâÂÖ®ÂâäÈô§ÔºàTruncateÔºâ„ÇíË°å„Åà„Çã PowerShell (WinForms) „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£„Åß„Åô„ÄÇ

### „Çø„ÉñÂà•„ÅÆÊ¥ªÁî®„Ç∑„Éº„É≥

- **Export**
  - „Éá„Éº„Çø„Çí CSV / JSON / Excel „Å´Âá∫Âäõ„Åó„ÄÅÂêÑÈÉ®ÁΩ≤„ÅßËá™Áî±„Å´ÈõÜË®à„ÉªÂä†Â∑•„ÉªÈÄ£Êê∫„Åó„Åü„ÅÑ„Å®„Åç„Å´ÊúâÂäπ„Åß„Åô„ÄÇ
  - ‰æãÔºöÈÅãÁî®ÈÉ®ÈñÄ„Åå Excel „Åß‰∏ÄÊ¨°ÂàÜÊûê„Åó„ÄÅÂà•„ÉÅ„Éº„É†„Åå JSON „Çí‰Ωø„Å£„Å¶Âà•„Ç∑„Çπ„ÉÜ„É†ÈÄ£Êê∫„Åô„Çã‰∏¶Ë°åÂà©Áî®„ÄÇ
- **Database View Editor**
  - ServiceNow Ê®ôÊ∫ñ UI „Åß„ÅØÊìç‰Ωú„Åó„Å•„Çâ„ÅÑ Database View ‰ΩúÊàê„Çí„ÄÅGUI „ÅßÊâãÊó©„ÅèÁµÑ„ÅøÁ´ã„Å¶„Åü„ÅÑ„Å®„Åç„Å´ÊúâÂäπ„Åß„Åô„ÄÇ
  - „ÉÜ„Éº„Éñ„É´/„Ç´„É©„É†ÂÄôË£ú„ÇíË¶ã„Å™„Åå„Çâ„ÄÅ„Éô„Éº„Çπ„ÉÜ„Éº„Éñ„É´„Å® JOIN „ÇíË®≠Ë®à„Åß„Åç„Åæ„Åô„ÄÇ
- **TruncateÔºàÂÖ®ÂâäÈô§Ôºâ**
  - ÈñãÁô∫Áí∞Â¢É„ÅßÊï∞‰∏á„Ç™„Éº„ÉÄ„Éº„ÅÆÂ§ßÈáè„Éá„Éº„Çø„Ç§„É≥„Éù„Éº„Éà„ÉÜ„Çπ„Éà„ÇíÁπ∞„ÇäËøî„Åó„ÄÅ„ÉÜ„Éº„Éñ„É´ÁÆ°ÁêÜÁîªÈù¢„Åã„Çâ„ÅÆ„É¨„Ç≥„Éº„ÉâÂâäÈô§„Åß„ÅØÂ§ßÂ§â„Å™Â†¥Âêà„Å´ÊúâÂäπ„Åß„Åô„ÄÇ
  - **Êú¨Áï™Áí∞Â¢É„Åß„ÅÆ‰ΩøÁî®„ÅØÈùûÊé®Â•®**„Åß„Åô„ÄÇ
- **Ë®≠ÂÆö**
  - „Ç§„É≥„Çπ„Çø„É≥„ÇπÂêç„ÉªË™çË®ºÊñπÂºè„ÉªË®ÄË™û„Å™„Å©„Çí‰øùÂ≠ò„Åó„ÄÅÁπ∞„ÇäËøî„Åó‰ΩúÊ•≠„ÅÆÂÖ•Âäõ„Éü„Çπ„ÇÑ„Çª„ÉÉ„Éà„Ç¢„ÉÉ„ÉóÊôÇÈñì„ÇíÊ∏õ„Çâ„Åó„Åü„ÅÑ„Å®„Åç„Å´ÊúâÂäπ„Åß„Åô„ÄÇ

### ÂâçÊèêÊù°‰ª∂

- Windows + PowerShell 5.1ÔºàWinForms Âà©Áî®„ÅÆ„Åü„ÇÅÔºâ
- ServiceNow „Ç§„É≥„Çπ„Çø„É≥„Çπ„Å´„Ç¢„ÇØ„Çª„Çπ„Åß„Åç„Çã„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ
- ÂØæË±°„ÉÜ„Éº„Éñ„É´ÂèÇÁÖßÊ®©ÈôêÔºàExportÔºâ„Åä„Çà„Å≥ Database View ‰ΩúÊàê„Å´ÂøÖË¶Å„Å™Ê®©ÈôêÔºàView EditorÔºâ

### Âü∫Êú¨ÁöÑ„Å™‰Ωø„ÅÑÊñπ

1. `PS1SNOWUtilities.ps1` „ÇíÂÆüË°å„Åó„Åæ„ÅôÔºàPowerShell 5.1 / STA Êé®Â•®Ôºâ„ÄÇ
2. **Ë®≠ÂÆö**„Çø„Éñ„Åß‰ª•‰∏ã„ÇíÂÖ•Âäõ„Åó„Åæ„Åô„ÄÇ
   - ServiceNow „Ç§„É≥„Çπ„Çø„É≥„ÇπÂêç
   - Ë™çË®ºÊñπÂºèÔºà„É¶„Éº„Ç∂ID+„Éë„Çπ„ÉØ„Éº„Éâ „Åæ„Åü„ÅØ API„Ç≠„ÉºÔºâ
   - ÂøÖË¶Å„Å´Âøú„Åò„Å¶ UI Ë®ÄË™û
3. ÂÖ•ÂäõÂÜÖÂÆπ„ÅØ `settings.json` „Å´Ëá™Âãï‰øùÂ≠ò„Åï„Çå„Åæ„Åô„ÄÇ

#### Export „ÅÆÊâãÈ†Ü

1. **Export**„Çø„Éñ„ÅßÂØæË±°„ÉÜ„Éº„Éñ„É´„ÇíÈÅ∏ÊäûÔºà„Åæ„Åü„ÅØÊâãÂãïÂÖ•ÂäõÔºâ„Åó„Åæ„Åô„ÄÇ
2. ÂøÖË¶Å„Å´Âøú„Åò„Å¶„Éï„Ç£„É´„ÇøÔºàÂÖ®‰ª∂ or `sys_updated_on` ÊúüÈñìÊåáÂÆöÔºâ„ÇíË®≠ÂÆö„Åó„Åæ„Åô„ÄÇ
3. „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÂÖà„Éï„Ç©„É´„ÉÄ„Å®Âá∫ÂäõÂΩ¢ÂºèÔºàCSV / JSON / ExcelÔºâ„ÇíÊåáÂÆö„Åó„Å¶ **ÂÆüË°å** „ÇíÊäº„Åó„Åæ„Åô„ÄÇ
4. „É≠„Ç∞„ÇíÁ¢∫Ë™ç„Åó„ÄÅÂøÖË¶Å„Å´Âøú„Åò„Å¶ **„Éï„Ç©„É´„ÉÄ„ÇíÈñã„Åè** „ÅßÂá∫ÂäõÂÖà„ÇíÈñã„Åç„Åæ„Åô„ÄÇ

#### Database View Editor „ÅÆÊâãÈ†Ü

1. **Database View Editor** „Çø„Éñ„Åß View ÂÜÖÈÉ®Âêç„Å® View „É©„Éô„É´„ÇíÂÖ•Âäõ„Åó„Åæ„Åô„ÄÇ
2. „Éô„Éº„Çπ„ÉÜ„Éº„Éñ„É´„ÇíÈÅ∏Êäû„Åó„ÄÅÂøÖË¶Å„Å´Âøú„Åò„Å¶„Éô„Éº„Çπ Prefix „ÇíË®≠ÂÆö„Åó„Åæ„Åô„ÄÇ
3. **JOINËøΩÂä†** „Åß JOIN „ÉÜ„Éº„Éñ„É´„ÉªÂ∑¶Âè≥„Ç´„É©„É†„ÉªVariable Prefix„ÉªLEFT JOIN Êù°‰ª∂„ÇíË®≠ÂÆö„Åó„Åæ„Åô„ÄÇ
4. **„Ç´„É©„É†ÂÜçÂèñÂæó** „Åß„Ç´„É©„É†ÂÄôË£ú„ÇíÂÜçË™≠„ÅøËæº„Åø„Åó„Åæ„ÅôÔºàÁèæÁä∂„ÅØÂÄôË£ú„Åå„Åù„ÅÆ„Åæ„ÅæË°®Á§∫„Ç´„É©„É†„Å®„Åó„Å¶Êâ±„Çè„Çå„Åæ„ÅôÔºâ„ÄÇ
5. **View‰ΩúÊàê** „ÇíÂÆüË°å„Åó„ÄÅÂÆå‰∫Ü„É≠„Ç∞„Å®„É™„É≥„ÇØÔºà‰ΩúÊàêÊ∏à„Åø View ‰∏ÄË¶ß / View ÂÆöÁæ©Ôºâ„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åô„ÄÇ

#### TruncateÔºàÂÖ®ÂâäÈô§Ôºâ„ÅÆÊâãÈ†Ü

1. **TruncateÔºàÂÖ®ÂâäÈô§Ôºâ**„Çø„Éñ„ÅßÂâäÈô§ÂØæË±°„ÉÜ„Éº„Éñ„É´„ÇíÈÅ∏ÊäûÔºà„Åæ„Åü„ÅØÊâãÂãïÂÖ•ÂäõÔºâ„Åó„Åæ„Åô„ÄÇ
2. ÊúÄÂ§ßÂÜçË©¶Ë°åÂõûÊï∞Ôºà1ÔΩû999Ôºâ„ÇíË®≠ÂÆö„Åó„ÄÅ**ÂÖ®‰ª∂ÂâäÈô§ÂÆüË°å** „ÇíÊäº„Åó„Åæ„Åô„ÄÇ
3. Ë°®Á§∫„Åï„Çå„ÇãÁ¢∫Ë™ç„Ç≥„Éº„ÉâÂÖ•Âäõ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„Åß4ÊñáÂ≠ó„Ç≥„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„ÄÅÂÆüË°åÁ¢∫Ë™ç„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÅßÊâøË™ç„Åó„Åæ„Åô„ÄÇ
4. ÈÄ≤Êçó„Éê„Éº„Å®„É≠„Ç∞„ÇíÁ¢∫Ë™ç„Åó„ÄÅÂøÖË¶Å„Å´Âøú„Åò„Å¶ÂÜçË©¶Ë°å„É≠„Ç∞ÔºàÊúÄÂ§ßÂÜçË©¶Ë°åÂõûÊï∞„Åæ„ÅßÔºâ„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åô„ÄÇ

> üí° ‰ΩøÁî®„Ç∑„ÉÅ„É•„Ç®„Éº„Ç∑„Éß„É≥ÔºöÈñãÁô∫Áí∞Â¢É„ÅßÊï∞‰∏á„Ç™„Éº„ÉÄ„Éº„ÅÆÂ§ßÈáè„Éá„Éº„Çø„Ç§„É≥„Éù„Éº„Éà„ÉÜ„Çπ„Éà„ÇíÁπ∞„ÇäËøî„Åô„Åü„ÇÅ„Å´ÂâäÈô§„Åó„Åü„ÅÑ„Åå„ÄÅ„ÉÜ„Éº„Éñ„É´ÁÆ°ÁêÜÁîªÈù¢„Åã„ÇâÂÆüÊñΩ„Åô„Çã„É¨„Ç≥„Éº„ÉâÂâäÈô§„Åß„ÅØÂ§ßÂ§â„Å™ÊôÇ„Å´‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ

> ‚ö†Ô∏è Êú¨Ê©üËÉΩ„ÅØÊú¨Áï™Áí∞Â¢É„Åß„ÅÆÂà©Áî®„ÇíÊé®Â•®„Åó„Åæ„Åõ„Çì„ÄÇÈñãÁô∫Áí∞Â¢É„Åß„ÅÆÂ§ßÈáè„Éá„Éº„Çø„Ç§„É≥„Éù„Éº„ÉàË©¶È®ì„Å™„Å©„ÄÅÈôêÂÆöÁöÑ„Å™Áî®ÈÄî„Åß„ÅÆ„ÅøÂà©Áî®„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

### Ë£úË∂≥ÔºàÊ®©Èôê„ÉªÂà∂Á¥ÑÔºâ

- „ÉÜ„Éº„Éñ„É´‰∏ÄË¶ß„ÅØ `sys_db_object` „Åã„ÇâÂèñÂæó„Åô„Çã„Åü„ÇÅ„ÄÅACL „Å´„Çà„Çä‰∏ÄË¶ßÂèñÂæó„Åß„Åç„Å™„ÅÑÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„ÅôÔºà„Åù„ÅÆÂ†¥Âêà„ÅØÊâãÂãïÂÖ•Âäõ„ÅßÂØæÂøúÔºâ„ÄÇ
- Áí∞Â¢É„Å´„Çà„Å£„Å¶„ÅØ Where Âè•„Åæ„Åü„ÅØ JOIN ÂÆöÁæ©„ÅÆËá™Âãï‰øùÂ≠ò„Å´Âà∂Á¥Ñ„Åå„ÅÇ„Çä„ÄÅView Êú¨‰Ωì‰ΩúÊàêÂæå„Å´ ServiceNow ÂÅ¥„ÅßÊâãÂãïË£úÂÆå„ÅåÂøÖË¶Å„Å™Â†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ

### Ë™çË®ºÊÉÖÂ†±„ÅÆ‰øùÂ≠òÊñπÂºèÔºà„Éë„Çπ„ÉØ„Éº„Éâ / API„Ç≠„ÉºÔºâ

- `settings.json` „Å´‰øùÂ≠ò„Åï„Çå„Çã `passwordEnc` / `apiKeyEnc` „ÅØ„ÄÅWindows „ÅÆ **DPAPI (CurrentUser)** „ÅßÊöóÂè∑Âåñ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ
- „Åù„ÅÆ„Åü„ÇÅ„ÄÅÈÄöÂ∏∏„ÅØ **Âêå„Åò Windows „É¶„Éº„Ç∂„Éº + Âêå„Åò PC** „Åß„ÅÆ„ÅøÂæ©Âè∑„Åß„Åç„ÄÅÂà•PC„Å∏ `settings.json` „Çí„Ç≥„Éî„Éº„Åó„Å¶„ÇÇË™≠„ÅøÂèñ„Çä„Åß„Åç„Åæ„Åõ„Çì„ÄÇ
- Âæ©Âè∑„Ç≠„Éº„Çí„É¨„Ç∏„Çπ„Éà„É™„Å∏Âà•‰øùÂ≠ò„Åô„ÇãÂÆüË£Ö„ÅØÊé°Áî®„Åó„Å¶„ÅÑ„Åæ„Åõ„ÇìÔºà„É¨„Ç∏„Çπ„Éà„É™‰æùÂ≠ò„Å™„ÅóÔºâ„ÄÇ
- „Çà„ÇäÂé≥Ê†º„Å´„Åó„Åü„ÅÑÂ†¥Âêà„ÅØ„ÄÅÊ¨°„ÅÆÈÅãÁî®„ÇíÊé®Â•®„Åó„Åæ„Åô„ÄÇ
  - API„Ç≠„Éº„ÅØÁü≠ÂØøÂëΩ„Éà„Éº„ÇØ„É≥Âåñ„ÉªÂÆöÊúü„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥„Åô„Çã
  - Á´ØÊú´ÁßªË°åÊôÇ„ÅØ `settings.json` „ÅÆÁßòÂØÜÊÉÖÂ†±„ÇíÂºï„ÅçÁ∂ô„Åå„ÅöÂÜçÂÖ•Âäõ„Åô„Çã
  - ‰ºÅÊ•≠Áí∞Â¢É„Åß„ÅØ Windows Credential Manager / SecretManagement ÈÄ£Êê∫„ÇíÊ§úË®é„Åô„Çã

### ÂÖçË≤¨‰∫ãÈ†Ö

Êú¨„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„ÅØ ServiceNow Á§æ„Å®„ÅØÁÑ°Èñ¢‰øÇ„Åß„ÅÇ„Çä„ÄÅServiceNow Á§æ„Å´„Çà„ÇãÊâøË™ç„Éª‰øùË®º„Éª„Çµ„Éù„Éº„Éà„ÇíÂèó„Åë„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ
„Åæ„Åü„ÄÅ‰ΩúÊàêËÄÖËá™Ë∫´„ÇÇÊú¨„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„ÅÆÂà©Áî®„Å´„Çà„ÇäÁîü„Åò„Åü„ÅÑ„Åã„Å™„ÇãÊêçÂÆ≥„Å´„Å§„ÅÑ„Å¶„ÇÇË≤¨‰ªª„ÇíË≤†„ÅÑ„Åæ„Åõ„Çì„ÄÇ„ÅîÂà©Áî®„Å´„ÅÇ„Åü„Å£„Å¶„ÅØ„ÄÅÂøÖ„ÅöÂà©Áî®ËÄÖËá™Ë∫´„ÅÆË≤¨‰ªª„ÅßÂçÅÂàÜ„Å´„ÉÜ„Çπ„Éà„Å®Á¢∫Ë™ç„ÇíË°å„Å£„Åü„ÅÜ„Åà„Åß„ÅîÊ¥ªÁî®„Åè„Å†„Åï„ÅÑ„ÄÇ

### „É©„Ç§„Çª„É≥„Çπ

Êú¨„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„ÅØ **MIT License** „ÅÆ‰∏ã„ÅßÊèê‰æõ„Åï„Çå„Åæ„Åô„ÄÇ  
Copyright (c) ixam.net  
https://www.ixam.net

---

## English

PS1 SNOW Utilities is a PowerShell (WinForms) utility for exporting ServiceNow table data, creating Database Views, and truncating table records with a guided GUI.

### Useful situations by tab

- **Export**
  - Best when you want to distribute data as CSV / JSON / Excel so each department can process it in its own workflow.
  - Example: the operations team analyzes in Excel while another team consumes JSON for system integration.
- **Database View Editor**
  - Best when ServiceNow's native UI feels cumbersome for building Database Views.
  - You can design base tables and joins while checking table/column candidates.
- **Truncate (Delete all)**
  - Useful when you repeatedly run large-volume import tests (tens of thousands of records) in development, and deleting records from the table management screen is too cumbersome.
  - **Not recommended for production use**.
- **Settings**
  - Best when you want to persist instance/auth/language preferences and reduce repeated setup time and input mistakes.

### Prerequisites

- Windows + PowerShell 5.1 (WinForms-based UI)
- Network access to your ServiceNow instance
- Appropriate permissions for table reads (Export) and Database View creation (View Editor)

### Basic Usage

1. Run `PS1SNOWUtilities.ps1` (PowerShell 5.1 / STA recommended).
2. In the **Settings** tab, configure:
   - ServiceNow instance name
   - Authentication method (User ID + Password or API Key)
   - UI language if needed
3. Inputs are auto-saved to `settings.json`.

#### Export workflow

1. In the **Export** tab, select the target table (or type it manually).
2. Optionally set filters (All records or `sys_updated_on` date range).
3. Choose an export directory and output format (CSV / JSON / Excel), then click **Execute**.
4. Check logs and use **Open Folder** to view exported files.

#### Database View Editor workflow

1. In the **Database View Editor** tab, enter the View name and label.
2. Select a base table, and set the base prefix if required.
3. Use **Add Join** to define join table, left/right columns, variable prefix, and LEFT JOIN options.
4. Click **Reload Columns** to refresh column candidates (currently, the loaded candidates are treated as visible columns as-is).
5. Click **Create View**, then review completion logs and links (created View list / View definition record).

#### Truncate (Delete all) workflow

1. In the **Truncate (Delete all)** tab, select the target table (or type it manually).
2. Set max retry count (1-999), then click **Execute Delete All Records**.
3. In the displayed verification-code dialog, enter the 4-character code, then approve the execution confirmation dialog.
4. Check the progress bar and logs, and review retry logs as needed (up to the max retry count).

> üí° Typical use case: You want to repeatedly delete data after large-volume import tests (tens of thousands of records) in development, but record-by-record deletion from the table management screen is too time-consuming.

> ‚ö†Ô∏è This feature is not recommended for production environments. Use it only for limited scenarios such as repeated large-volume import tests in development environments.

### Notes (permissions and limitations)

- The table list is retrieved from `sys_db_object`; if blocked by ACL, enter table names manually.
- Depending on your instance, automatic persistence of where clause or join definitions may be limited. In that case, complete them manually in ServiceNow after the View itself is created.

### Credential storage model (Password / API Key)

- `passwordEnc` and `apiKeyEnc` in `settings.json` are encrypted with Windows **DPAPI (CurrentUser)**.
- In normal use, secrets can be decrypted only by the **same Windows user on the same machine**. Copying `settings.json` to another PC should not make secrets readable.
- This project does not rely on a separate registry-stored decryption key.
- For stricter operations, consider:
  - Short-lived API tokens with regular rotation
  - Re-entering secrets after device migration instead of carrying encrypted blobs
  - Enterprise-backed secret stores (Windows Credential Manager / SecretManagement)

### Disclaimer

This software is not affiliated with ServiceNow, and is not endorsed, supported, or warranted by ServiceNow.
The author also accepts no liability for any damages arising from the use of this software. You are responsible for thoroughly testing and verifying it before use.

### License

This software is licensed under the **MIT License**.  
Copyright (c) ixam.net  
https://www.ixam.net

### Images
<img width="1106" height="713" alt="snow_util_01" src="https://github.com/user-attachments/assets/1eea1cf8-c8b2-4a61-a71d-387daa5a8513" />
<img width="1106" height="713" alt="snow_util_02" src="https://github.com/user-attachments/assets/8b73fb3e-fede-45a3-96fa-4bdee30567fc" />
<img width="1106" height="713" alt="snow_util_03" src="https://github.com/user-attachments/assets/242a2530-b023-437f-8866-95f226f42d52" />
